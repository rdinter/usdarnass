<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with usdarnass • usdarnass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with usdarnass">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-77026562-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-77026562-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">usdarnass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/usdarnass.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/usdarnass_output.html">Output of usdarnass</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rdinter/usdarnass">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting started with usdarnass</h1>
                        <h4 class="author">Robert Dinterman</h4>
            
            <h4 class="date">2019-06-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rdinter/usdarnass/blob/master/vignettes/usdarnass.Rmd"><code>vignettes/usdarnass.Rmd</code></a></small>
      <div class="hidden name"><code>usdarnass.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>usdarnass</code> provides an alternative for downloading various USDA data from <a href="https://quickstats.nass.usda.gov/">https://quickstats.nass.usda.gov/</a> through R. You must sign up for an <a href="https://quickstats.nass.usda.gov/api">API key</a> from the mentioned website in order for this package to work.</p>
<p>The USDA’s documentation on Quick Stats can be found throughout <a href="https://www.nass.usda.gov/Quick_Stats/index.php">https://www.nass.usda.gov/Quick_Stats/index.php</a>. A short description of what the data entail can be summarised from the Quick Stats description on <a href="https://catalog.data.gov/dataset/quick-stats-agricultural-database">data.gov</a>:</p>
<blockquote>
<p>Quick Stats is the National Agricultural Statistics Service’s (NASS) online, self-service tool to access complete results from the 1997, 2002, 2007, and 2012 Censuses of Agriculture as well as the best source of NASS survey published estimates. The census collects data on all commodities produced on U.S. farms and ranches, as well as detailed information on expenses, income, and operator characteristics. The surveys that NASS conducts collect information on virtually every facet of U.S. agricultural production.</p>
</blockquote>
<p>There are two main USDA sources within Quick Stats: censuses and surveys. The census values in Quick Stats start in 1997 while the survey values can range all the way back to 1850 and then annually since 1866. Although Agricultural Censuses occur once every 5 years (1997, 2002, 2007, 2012, and most recently 2017), USDA will administer other censuses, for instance the <a href="https://www.nass.usda.gov/Surveys/Guide_to_NASS_Surveys/Census_of_Aquaculture/">Census of Aquaculture</a>, which explains the additional years of available census data. At this time, there is no support for documenting the various kinds of data which can be extracted from Quick Stats and this package only serves as an R interface for downloading Quick Stats data. It is up to the user to understand the source of the data they download, most of which can be found at <a href="https://www.nass.usda.gov/Surveys/">https://www.nass.usda.gov/Surveys/</a>.</p>
<!-- The core functions are -->
<!-- - `nass_set_key()` - set the required USDA Quickstats API key for the session. -->
<!-- - `nass_param()` - extract all of the valid values for a particular parameter. -->
<!-- - `nass_count()` - number of observations in a particular query, helpful in determining if a query fits within the 50,000 limit. -->
<!-- - `nass_data()` - return a data.frame with the observations that fit within a query, however any query that returns more than 50,000 observations returns an error and it will need to be subset. -->
</div>
<div id="package-install" class="section level1">
<h1 class="hasAnchor">
<a href="#package-install" class="anchor"></a>Package Install</h1>
<p><code>usdarnass</code> is currently on CRAN and can be installed with the typical method of using <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages("usdarnass")</a></code> in R. However, if you would like the development version then it can be installed with the use of <code>devtools</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"rdinter/usdarnass"</span>)</a></code></pre></div>
<p>Load package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"usdarnass"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level1">
<h1 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h1>
<p>If a query works on the <a href="https://quickstats.nass.usda.gov/">https://quickstats.nass.usda.gov/</a> interface, then it will work with the <code>usdarnass</code> package. Keep in mind that there is a 50,000 observation limit for both the web interface and data queries with this package.</p>
<p>There are three main functions for this package with the first as the workhorse:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/nass_data.html">nass_data()</a></code> this will return a data.frame to the specifications of the query from all of the arguments set in the function call. This mimics the simple “GET DATA” command off of <a href="https://quickstats.nass.usda.gov/">https://quickstats.nass.usda.gov/</a> and requires an API key. There is a 50,000 limit for each call.</li>
<li>
<code><a href="../reference/nass_param.html">nass_param()</a></code> returns all of the possible values for a parameter in a query. Helpful to understand how to subset a query if it runs into the 50,000 limit.</li>
<li>
<code><a href="../reference/nass_count.html">nass_count()</a></code> returns the number of records for a query. Very useful in conjunction with <code><a href="../reference/nass_param.html">nass_param()</a></code> to determine what queries can return data with a <code><a href="../reference/nass_data.html">nass_data()</a></code> call.</li>
</ol>
<p>All of these functions require an API Key for each query, which can be set with another function.</p>
<div id="key-install" class="section level2">
<h2 class="hasAnchor">
<a href="#key-install" class="anchor"></a>Key Install</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/nass_set_key.html">nass_set_key</a></span>(<span class="st">"YOUR_KEY_IN_QUOTATIONS"</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># First time, reload your enviornment so you can use the key without restarting R.</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readRenviron">readRenviron</a></span>(<span class="st">"~/.Renviron"</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># You can check it with:</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.getenv">Sys.getenv</a></span>(<span class="st">"NASS_KEY"</span>)</a></code></pre></div>
<p>The above script will add a line to your <code>.Renviron</code> file to be re-used whenever you are using the package. If you are not comfortable with the package writing to your home directory, you can add the following line to your <code>.Renviron</code> file manually to produce the same result. The function <code><a href="https://usethis.r-lib.org/reference/edit.html">usethis::edit_r_environ()</a></code> should open up your <code>.Renviron</code> file for you to make edits to with the following line (use your actual API key for the right hand side value):</p>
<p><code>NASS_KEY = 'YOUR_KEY_IN_QUOTATIONS'</code></p>
<p>If you are not comfortable with either of these options, then to use the package you need to ensure that the <code>key</code> parameter is set to your API key in each of your function calls that queries USDA Quick Stats.</p>
</div>
</div>
<div id="get-data" class="section level1">
<h1 class="hasAnchor">
<a href="#get-data" class="anchor"></a>Get Data</h1>
<p>As previously stated, the workhorse function is the <code><a href="../reference/nass_data.html">nass_data()</a></code> function which will make query calls and return a data.frame as long as the query will return 50,000 or fewer observations. Each argument in the function call corresponds to the categories which are displayed on the web interface of Quick Stats. The arguments accept character values and even character vectors in the case of multiple selections in a category. By way of an example, we can put in a query to Quick Stats for the value of agricultural land (and buildings) in Durham and Wake County North Carolina for 2012 (warning: there is a lot of information :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">nc_vals &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nass_data.html">nass_data</a></span>(<span class="dt">year =</span> <span class="dv">2012</span>,</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">                     <span class="dt">short_desc =</span> <span class="st">"AG LAND, INCL BUILDINGS - ASSET VALUE, MEASURED IN $"</span>,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                     <span class="dt">county_name =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Durham"</span>, <span class="st">"WAKE"</span>),</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                     <span class="dt">state_name =</span> <span class="st">"NORTH CAROLINA"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(nc_vals)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 'data.frame':    2 obs. of  39 variables:</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  $ domaincat_desc       : chr  "NOT SPECIFIED" "NOT SPECIFIED"</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  $ unit_desc            : chr  "$" "$"</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  $ country_code         : chr  "9000" "9000"</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  $ short_desc           : chr  "AG LAND, INCL BUILDINGS - ASSET VALUE, MEASURED IN $" "AG LAND, INCL BUILDINGS - ASSET VALUE, MEASURED IN $"</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  $ freq_desc            : chr  "POINT IN TIME" "POINT IN TIME"</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  $ zip_5                : chr  "" ""</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  $ end_code             : chr  "12" "12"</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  $ domain_desc          : chr  "TOTAL" "TOTAL"</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;  $ county_name          : chr  "DURHAM" "WAKE"</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;  $ util_practice_desc   : chr  "ALL UTILIZATION PRACTICES" "ALL UTILIZATION PRACTICES"</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;  $ state_fips_code      : chr  "37" "37"</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;  $ year                 : int  2012 2012</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;  $ begin_code           : chr  "12" "12"</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;  $ watershed_desc       : chr  "" ""</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;  $ agg_level_desc       : chr  "COUNTY" "COUNTY"</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;  $ region_desc          : chr  "" ""</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;  $ country_name         : chr  "UNITED STATES" "UNITED STATES"</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;  $ reference_period_desc: chr  "</span><span class="re">END</span><span class="co"> OF DEC" "</span><span class="re">END</span><span class="co"> OF DEC"</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt;  $ source_desc          : chr  "CENSUS" "CENSUS"</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt;  $ prodn_practice_desc  : chr  "ALL PRODUCTION PRACTICES" "ALL PRODUCTION PRACTICES"</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt;  $ congr_district_code  : chr  "" ""</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt;  $ load_time            : chr  "2012-12-31 00:00:00" "2012-12-31 00:00:00"</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt;  $ Value                : chr  "178,892,000" "806,464,000"</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt;  $ location_desc        : chr  "NORTH CAROLINA, NORTHERN PIEDMONT, DURHAM" "NORTH CAROLINA, CENTRAL PIEDMONT, WAKE"</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt;  $ class_desc           : chr  "INCL BUILDINGS" "INCL BUILDINGS"</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt;  $ week_ending          : chr  "" ""</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;  $ county_ansi          : chr  "063" "183"</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt;  $ state_ansi           : chr  "37" "37"</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt;  $ state_alpha          : chr  "NC" "NC"</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt;  $ CV (%)               : chr  "7.9" "7.9"</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt;  $ county_code          : chr  "063" "183"</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt;  $ state_name           : chr  "NORTH CAROLINA" "NORTH CAROLINA"</span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt;  $ statisticcat_desc    : chr  "ASSET VALUE" "ASSET VALUE"</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt;  $ watershed_code       : chr  "00000000" "00000000"</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt;  $ asd_desc             : chr  "NORTHERN PIEDMONT" "CENTRAL PIEDMONT"</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt;  $ commodity_desc       : chr  "AG LAND" "AG LAND"</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt;  $ group_desc           : chr  "FARMS &amp; LAND &amp; ASSETS" "FARMS &amp; LAND &amp; ASSETS"</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt;  $ asd_code             : chr  "40" "50"</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt;  $ sector_desc          : chr  "ECONOMICS" "ECONOMICS"</span></a></code></pre></div>
<p>The output of this query has a lot to digest. The main focus is on the <code>Value</code> variable in the resulting data.frame. Please note that the returned <code>Value</code> for the query is of the class character. The parameter <code>numeric_vals</code> can be set to <code>TRUE</code> to have this return a numeric value, however the default is to be a character type as there are some suppressed values which will be coerced to <code>NA</code> when <code>numeric_vals</code> is set to <code>TRUE</code>.</p>
<p>Aside from the output, the particular query used four parameters for its output: <code>year</code>, <code>short_desc</code>, <code>county_name</code>, and <code>state_name</code>. Each of these parameters have a particular set of values which can generate of query, which can be figured out using the <code><a href="../reference/nass_param.html">nass_param()</a></code> function. The <code>year</code> argument is the only argument that accepts either a character or numeric value, all other arguments only accept character vectors which can be multiple values in the case of <code>county_name</code> in the call above. The arguments for <code>usdarnass</code> are not case sensitive. Whether the county is called “Durham”, “durham”, “DURHAM”, or “dUrHaM” the parameter will be ultimately passed to the API the same.</p>
<p>In querying the Quick Stats API, you usually do not need to subset many parameters to get to the 50,000 limitation but if you do not get within the 50,000 limitation the call will produce an error. As of right now, there are 18 parameters for each query, although most of those will be <code>NULL</code> values and not required to specify an output.</p>
<div id="parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters" class="anchor"></a>Parameters</h2>
<p>There are 18 parameters which can be included in each query to Quick Stats however some of them are concatenations of other parameter values. If there is a name in quotations following a particular parameter, then that is the drop down menu via the <a href="https://www.nass.usda.gov/Quick_Stats/index.php">Quick Stats web interface</a> that gives you a value. Not all parameters will have a drop down menu though:</p>
<ol style="list-style-type: decimal">
<li>
<code>source_desc</code> “Program” - Source of data (“CENSUS” or “SURVEY”). Census program includes the Census of Ag as well as follow up projects. Survey program includes national, state, and county surveys.</li>
<li>
<code>sector_desc</code> “Sector” - Five high level, broad categories useful to narrow down choices. (“ANIMALS &amp; PRODUCTS”, “CROPS”, “DEMOGRAPHICS”, “ECONOMICS”, or “ENVIRONMENTAL”)</li>
<li>
<code>group_desc</code> “Group” - Subsets within sector (e.g., under sector_desc = “CROPS”, the groups are “FIELD CROPS”, “FRUIT &amp; TREE NUTS”, “HORTICULTURE”, and “VEGETABLES”).</li>
<li>
<code>commodity_desc</code> “Commodity” - The primary subject of interest (e.g., “CORN”, “CATTLE”, “LABOR”, “TRACTORS”, “OPERATORS”).</li>
<li>
<code>short_desc</code> “Data Item” - A concatenation of six columns: commodity_desc, class_desc, prodn_practice_desc, util_practice_desc, statisticcat_desc, and unit_desc.</li>
<li>
<code>domain_desc</code> “Domain” - Generally another characteristic of operations that produce a particular commodity (e.g., “ECONOMIC CLASS”, “AREA OPERATED”, “NAICS CLASSIFICATION”, “SALES”). For chemical usage data, the domain describes the type of chemical applied to the commodity. The domain_desc = “TOTAL” will have no further breakouts; i.e., the data value pertains completely to the short_desc.</li>
<li>
<code>domaincat_desc</code> “Domain Category” - Categories or partitions within a domain (e.g., under domain_desc = “SALES”, domain categories include $1,000 TO $9,999, $10,000 TO $19,999, etc).</li>
<li>
<code>agg_level_desc</code> “Geographic Level” - Aggregation level or geographic granularity of the data. (“AGRICULTURAL DISTRICT”, “COUNTY”, “INTERNATIONAL”, “NATIONAL”, “REGION : MULTI-STATE”, “REGION : SUB-STATE”, “STATE”, “WATERSHED”, or “ZIP CODE”)</li>
<li>
<code>statisticcat_desc</code> “Category” - The aspect of a commodity being measured (e.g., “AREA HARVESTED”, “PRICE RECEIVED”, “INVENTORY”, “SALES”).</li>
<li>
<code>state_name</code> “State” - State full name.</li>
<li>
<code>asd_desc</code> “Ag District” - Ag statistics district name.</li>
<li>
<code>county_name</code> “County” - County name.</li>
<li>
<code>region_desc</code> “Region” - NASS defined geographic entities not readily defined by other standard geographic levels. A region can be a less than a state (SUB-STATE) or a group of states (MULTI-STATE), and may be specific to a commodity.</li>
<li>
<code>zip_5</code> “Zip Code” - US Postal Service 5-digit zip code.</li>
<li>
<code>watershed_desc</code> “Watershed” - Name assigned to the HUC.</li>
<li>
<code>year</code> “Year” - The numeric year of the data and can be either a character or numeric vector. Conditional values are also possible, for example a character vector of “&gt;=1999” of “1999&lt;=” will give years greater than or equal to 1999. Right now the logical values can either be greater/less than or equal to with the logical at either the beginning or end of a string with the year.</li>
<li>
<code>freq_desc</code> “Period Type” - Length of time covered (“ANNUAL”, “SEASON”, “MONTHLY”, “WEEKLY”, “POINT IN TIME”). “MONTHLY” often covers more than one month. “POINT IN TIME” is as of a particular day.</li>
<li>
<code>reference_period_desc</code> “Period” - The specific time frame, within a freq_desc.</li>
</ol>
<p>The descriptions of parameters here are minimal as most of the actual parameters have a vast amount of available options. This is where the <code><a href="../reference/nass_param.html">nass_param()</a></code> function comes into play in order to give the full set of values for each parameter.</p>
</div>
</div>
<div id="get-parameter" class="section level1">
<h1 class="hasAnchor">
<a href="#get-parameter" class="anchor"></a>Get Parameter</h1>
<p>The <code><a href="../reference/nass_param.html">nass_param()</a></code> function will return a vector of all the possible values for a parameter conditional on the other parameter subsets given above. We can see that there are only two sources of datasets for the Quick Stats queries by asking what the values for the <code>source_desc</code> parameter are:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/nass_param.html">nass_param</a></span>(<span class="st">"source_desc"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] "CENSUS" "SURVEY"</span></a></code></pre></div>
<p>The first argument in <code><a href="../reference/nass_param.html">nass_param()</a></code> is the parameter of interest, which can take on any of the 18 values from the parameters section. This argument must be passed in a character format, so make sure to use quotations in your calls. The characters are also not case sensitive in the calls.</p>
<p>This function is most helpful in determining what variables are available for a certain subset. For example, if I was interested in what county level variables in Ohio are available in 2000 I might start by determining what “Group” is available at that level:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/nass_param.html">nass_param</a></span>(<span class="st">"group_desc"</span>,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">           <span class="dt">state_name =</span> <span class="st">"OHIO"</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">           <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">           <span class="dt">year =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; [1] "DAIRY"                 "FARMS &amp; LAND &amp; ASSETS" "FIELD CROPS"          </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [4] "LIVESTOCK"             "VEGETABLES"</span></a></code></pre></div>
<p>Now, if I want to further figure out what commodities are available for the “DAIRY” subset of this data but only after 2000, I would make a call of:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/nass_param.html">nass_param</a></span>(<span class="st">"commodity_desc"</span>,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">           <span class="dt">group_desc =</span> <span class="st">"dairy"</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">           <span class="dt">state_name =</span> <span class="st">"OHIO"</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">           <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">           <span class="dt">year =</span> <span class="st">"&gt;2000"</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; [1] "MILK"</span></a></code></pre></div>
<p>While the <code>year</code> parameter does not need to be a character vector, it does accept relational operators which can modify the subsets even further for queries.</p>
</div>
<div id="get-count" class="section level1">
<h1 class="hasAnchor">
<a href="#get-count" class="anchor"></a>Get Count</h1>
<p>Every query with <code><a href="../reference/nass_data.html">nass_data()</a></code> has a 50,000 limit of observations. In order to determine the number of observations in a query, the <code><a href="../reference/nass_count.html">nass_count()</a></code> function will accept all the same parameters as <code><a href="../reference/nass_data.html">nass_data()</a></code> but its output is a numeric of the observations in a query:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/nass_count.html">nass_count</a></span>()</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; [1] 41628968</span></a></code></pre></div>
<p>Here we see how many observations are currently in the Quick Stats as of 2019-06-29. Clearly, the entire data can not be downloaded with a query of their API. If you are concerned about downloading all of the Quick Stats data, then it would be more efficient to use their ftp site <a href="ftp://ftp.nass.usda.gov/quickstats/">ftp://ftp.nass.usda.gov/quickstats/</a>.</p>
<p>By way of another example, we can look at how many observations are available related to agricultural land at the county level:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/nass_count.html">nass_count</a></span>(<span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">           <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; [1] 2053425</span></a></code></pre></div>
<p>This particular query would not be able to be run for <code><a href="../reference/nass_data.html">nass_data()</a></code> because the number of observations greatly exceeds 50,000 and indeed that query returns an error:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/nass_data.html">nass_data</a></span>(<span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">          <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; Error in nass_data(commodity_desc = "AG LAND", agg_level_desc = "COUNTY"): Query returns 2,053,425 records. The limit is 50,000. Subset the query to fit within limit. See nass_count()</span></a></code></pre></div>
<p>At this point in time a bit of understanding of the data and the user’s goals are needed. If there is only one state of interest for the study, then subsetting the data further to a state is likely the best strategy. However, it is more likely that the user wants the all county level data related to agricultural land. My strategy would be to look at the number of observations for each year of interest to my data request. I would then take a vector of potential values for years and iterate a call to <code>nass_count</code> over each year to determine the count of values for each year:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">years        &lt;-<span class="st"> </span><span class="dv">2000</span><span class="op">:</span><span class="dv">2017</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(years) &lt;-<span class="st"> </span><span class="dv">2000</span><span class="op">:</span><span class="dv">2017</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(years,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">       <span class="cf">function</span>(x) <span class="kw"><a href="../reference/nass_count.html">nass_count</a></span>(<span class="dt">year =</span> x,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                              <span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">                              <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>), <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt;   2000   2001   2002   2003   2004   2005   2006   2007   2008   2009 </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;      0      0 418908      0      0      0      0 436633      0      0 </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;   2010   2011   2012   2013   2014   2015   2016   2017 </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;      0      0 422050      0      0      0      0 417663</span></a></code></pre></div>
<p>The observations here are only related to 2002, 2007, and 2012 which are agricultural census years and it is highly likely that there are a lot of variables in the category what would likely not be excessive information. It is then best to look at the descriptions of the variables to figure out what data would be most useful:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">agland_params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nass_param.html">nass_param</a></span>(<span class="st">"short_desc"</span>,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                            <span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">                            <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">                            <span class="dt">year =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2002</span>, <span class="dv">2007</span>, <span class="dv">2012</span>))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(agland_params)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; [1] 60</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(agland_params[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>],</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">       <span class="cf">function</span>(x) <span class="kw"><a href="../reference/nass_count.html">nass_count</a></span>(<span class="dt">short_desc =</span> x,</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">                              <span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">                              <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>,</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">                              <span class="dt">year =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2002</span>, <span class="dv">2007</span>, <span class="dv">2012</span>)))</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt;                                                          AG LAND - ACRES </span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt;                                                                     9128 </span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt;                                           AG LAND - NUMBER OF OPERATIONS </span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt;                                                                     9128 </span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt;                                        AG LAND - OPERATIONS WITH TREATED </span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt;                                                                    59228 </span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt;                                     AG LAND - TREATED, MEASURED IN ACRES </span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt;                                                                    59228 </span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt;                AG LAND, (EXCL CROPLAND &amp; PASTURELAND &amp; WOODLAND) - ACRES </span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt;                                                                     9222 </span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; AG LAND, (EXCL CROPLAND &amp; PASTURELAND &amp; WOODLAND) - NUMBER OF OPERATIONS </span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt;                                                                     9222</span></a></code></pre></div>
<p>There are many parameter values in that query, but only the first 6 are displayed to save space. While most of these data items fit within the 50,000 limit, not all do. Take for example the “AG LAND - TREATED, MEASURED IN ACRES” category exceeds the limit and would not be able to be downloaded. This is because the treated category actually has multiple domains which can be seen by combining the <code><a href="../reference/nass_param.html">nass_param()</a></code> and <code><a href="../reference/nass_count.html">nass_count()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">agland_domain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nass_param.html">nass_param</a></span>(<span class="st">"domain_desc"</span>,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                            <span class="dt">short_desc =</span> <span class="st">"AG LAND - TREATED, MEASURED IN ACRES"</span>,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                            <span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                            <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(agland_domain,</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">       <span class="cf">function</span>(x) <span class="kw"><a href="../reference/nass_count.html">nass_count</a></span>(<span class="dt">domain_desc =</span> x,</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">                              <span class="dt">short_desc =</span> <span class="st">"AG LAND - TREATED, MEASURED IN ACRES"</span>,</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">                              <span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">                              <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;   CHEMICAL, FUNGICIDE   CHEMICAL, HERBICIDE CHEMICAL, INSECTICIDE </span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt;                 13998                 15296                 27098 </span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt;       CHEMICAL, OTHER            FERTILIZER </span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt;                 12092                 30215</span></a></code></pre></div>
<p>To download the above data, one would need to iterate over each of the <code>domain_desc</code> values in order to fit within the limits. The <code>lapply</code> method is likely the easiest way to accomplish this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">agland_domain_download &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(agland_domain,</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">                                 <span class="cf">function</span>(x) <span class="kw"><a href="../reference/nass_data.html">nass_data</a></span>(<span class="dt">domain_desc =</span> x,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                                                       <span class="dt">short_desc =</span> <span class="st">"AG LAND - TREATED, MEASURED IN ACRES"</span>,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                                                       <span class="dt">commodity_desc =</span> <span class="st">"AG LAND"</span>,</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                                                       <span class="dt">agg_level_desc =</span> <span class="st">"COUNTY"</span>))</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">agland_domain_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/do.call">do.call</a></span>(<span class="st">"rbind"</span>, agland_domain_download)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#package-install">Package Install</a></li>
      <li>
<a href="#usage">Usage</a><ul class="nav nav-pills nav-stacked">
<li><a href="#key-install">Key Install</a></li>
      </ul>
</li>
      <li>
<a href="#get-data">Get Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#parameters">Parameters</a></li>
      </ul>
</li>
      <li><a href="#get-parameter">Get Parameter</a></li>
      <li><a href="#get-count">Get Count</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robert Dinterman, Jonathan Eyer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
