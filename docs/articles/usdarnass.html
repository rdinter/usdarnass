<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with usdarnass • usdarnass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with usdarnass">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-77026562-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-77026562-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">usdarnass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/usdarnass.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rdinter/usdarnass">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting started with usdarnass</h1>
                        <h4 class="author">Robert Dinterman</h4>
            
            <h4 class="date">2018-11-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rdinter/usdarnass/blob/master/vignettes/usdarnass.Rmd"><code>vignettes/usdarnass.Rmd</code></a></small>
      <div class="hidden name"><code>usdarnass.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>usdarnass</code> provides an alternative for downloading various USDA data from <a href="https://quickstats.nass.usda.gov/" class="uri">https://quickstats.nass.usda.gov/</a> through R. You must sign up for an <a href="https://quickstats.nass.usda.gov/api">API key</a> from the mentioned website in order for this package to work.</p>
<p>The USDA’s documentation on Quick Stats can be found throughout <a href="https://www.nass.usda.gov/Quick_Stats/index.php" class="uri">https://www.nass.usda.gov/Quick_Stats/index.php</a>. A short description of what the data entail can be summarised from the Quick Stats description on <a href="https://catalog.data.gov/dataset/quick-stats-agricultural-database">data.gov</a>:</p>
<blockquote>
<p>Quick Stats is the National Agricultural Statistics Service’s (NASS) online, self-service tool to access complete results from the 1997, 2002, 2007, and 2012 Censuses of Agriculture as well as the best source of NASS survey published estimates. The census collects data on all commodities produced on U.S. farms and ranches, as well as detailed information on expenses, income, and operator characteristics. The surveys that NASS conducts collect information on virtually every facet of U.S. agricultural production.</p>
</blockquote>
<p>There are two main USDA sources within Quick Stats: censuses and surveys. The census values in Quick Stats start in 1997 while the survey values can range all the way back to 1850 and then annually since 1866. Although Agricultural Censuses occur once every 5 years (1997, 2002, 2007, 2012, and eventually 2017), USDA will administer other censuses which explains the extra years available. At this time, there is no support for documenting the various kinds of data which can be extracted from Quick Stats and this package only serves as an R interface for downloading Quick Stats data and it is up to the user to understand the source of the data they download.</p>
<!-- The core functions are -->
<!-- - `nass_set_key()` - set the required USDA Quickstats API key for the session. -->
<!-- - `nass_param()` - extract all of the valid values for a particular parameter. -->
<!-- - `nass_count()` - number of observations in a particular query, helpful in determining if a query fits within the 50,000 limit. -->
<!-- - `nass_data()` - return a data.frame with the observations that fit within a query, however any query that returns more than 50,000 observations returns an error and it will need to be subset. -->
</div>
<div id="package-install" class="section level1">
<h1 class="hasAnchor">
<a href="#package-install" class="anchor"></a>Package Install</h1>
<p>Development version (needs devtools installed):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"rdinter/usdarnass"</span>)</code></pre></div>
<p>Load package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"usdarnass"</span>)</code></pre></div>
</div>
<div id="usage" class="section level1">
<h1 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h1>
<p>If a query works on the <a href="https://quickstats.nass.usda.gov/" class="uri">https://quickstats.nass.usda.gov/</a> interface, then it will work with the <code>usdarnass</code> package. Keep in mind that there is a 50,000 observation limit for both the web interface and data queries with this package.</p>
<p>There are three main functions for this package with the first as the workhorse:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/nass_data.html">nass_data()</a></code> this will return a data.frame to the specifications of the query from all of the arguments set in the function call. This mimics the simple “GET DATA” command off of <a href="https://quickstats.nass.usda.gov/" class="uri">https://quickstats.nass.usda.gov/</a> and requires an API key. There is a 50,000 limit for each call.</li>
<li>
<code><a href="../reference/nass_param.html">nass_param()</a></code> returns all of the possible values for a parameter in a query. Helpful to understand how to subset a query if it runs into the 50,000 limit.</li>
<li>
<code><a href="../reference/nass_count.html">nass_count()</a></code> returns the number of records for a query. Very useful in conjunction with <code><a href="../reference/nass_param.html">nass_param()</a></code> to determine what queries can return data with a <code><a href="../reference/nass_data.html">nass_data()</a></code> call.</li>
</ol>
<p>All of these functions require an API Key for each query, which can be set with another function.</p>
<div id="key-install" class="section level2">
<h2 class="hasAnchor">
<a href="#key-install" class="anchor"></a>Key Install</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set_nass_key</span>(<span class="st">"YOUR_KEY_IN_QUOTATIONS"</span>)
<span class="co"># First time, reload your enviornment so you can use the key without restarting R.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readRenviron">readRenviron</a></span>(<span class="st">"~/.Renviron"</span>)
<span class="co"># You can check it with:</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.getenv">Sys.getenv</a></span>(<span class="st">"NASS_KEY"</span>)</code></pre></div>
<p>The above script will add a line to your <code>.Renviron</code> file to be re-used whenever you are using the package. If you are not comfortable with that, you can add the following line to your <code>.Renviron</code> file manually to produce the same result.</p>
<p><code>NASS_KEY = 'YOUR_KEY_IN_SINGLE_QUOTES'</code></p>
<p>If you are not comfortable with either of these options, then to use the package you need to ensure that the <code>token</code> parameter is set to your API key in each of your function calls that queries USDA Quickstats.</p>
</div>
</div>
<div id="get-data" class="section level1">
<h1 class="hasAnchor">
<a href="#get-data" class="anchor"></a>Get Data</h1>
<p>As previously stated, the workhorse function is the <code><a href="../reference/nass_data.html">nass_data()</a></code> function which will make query calls and return a data.frame as long as the query will return 50,000 or fewer observations. By way of example, we can put in a query to Quick Stats for the value of agricultural land (and buildings) in Wake County North Carolina for 2012:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">j5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nass_data.html">nass_data</a></span>(<span class="dt">year =</span> <span class="dv">2012</span>,
                <span class="dt">short_desc =</span> <span class="st">"AG LAND, INCL BUILDINGS - ASSET VALUE, MEASURED IN $"</span>,
                <span class="dt">county_name =</span> <span class="st">"WAKE"</span>,
                <span class="dt">state_name =</span> <span class="st">"NORTH CAROLINA"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(j5)
<span class="co">#&gt; 'data.frame':    1 obs. of  39 variables:</span>
<span class="co">#&gt;  $ week_ending          : chr ""</span>
<span class="co">#&gt;  $ state_name           : chr "NORTH CAROLINA"</span>
<span class="co">#&gt;  $ country_code         : chr "9000"</span>
<span class="co">#&gt;  $ location_desc        : chr "NORTH CAROLINA, CENTRAL PIEDMONT, WAKE"</span>
<span class="co">#&gt;  $ begin_code           : chr "12"</span>
<span class="co">#&gt;  $ zip_5                : chr ""</span>
<span class="co">#&gt;  $ county_ansi          : chr "183"</span>
<span class="co">#&gt;  $ state_alpha          : chr "NC"</span>
<span class="co">#&gt;  $ util_practice_desc   : chr "ALL UTILIZATION PRACTICES"</span>
<span class="co">#&gt;  $ domain_desc          : chr "TOTAL"</span>
<span class="co">#&gt;  $ asd_desc             : chr "CENTRAL PIEDMONT"</span>
<span class="co">#&gt;  $ freq_desc            : chr "POINT IN TIME"</span>
<span class="co">#&gt;  $ prodn_practice_desc  : chr "ALL PRODUCTION PRACTICES"</span>
<span class="co">#&gt;  $ end_code             : chr "12"</span>
<span class="co">#&gt;  $ sector_desc          : chr "ECONOMICS"</span>
<span class="co">#&gt;  $ short_desc           : chr "AG LAND, INCL BUILDINGS - ASSET VALUE, MEASURED IN $"</span>
<span class="co">#&gt;  $ country_name         : chr "UNITED STATES"</span>
<span class="co">#&gt;  $ Value                : chr "806,464,000"</span>
<span class="co">#&gt;  $ reference_period_desc: chr "</span><span class="re">END</span><span class="co"> OF DEC"</span>
<span class="co">#&gt;  $ CV (%)               : chr "7.9"</span>
<span class="co">#&gt;  $ class_desc           : chr "INCL BUILDINGS"</span>
<span class="co">#&gt;  $ asd_code             : chr "50"</span>
<span class="co">#&gt;  $ agg_level_desc       : chr "COUNTY"</span>
<span class="co">#&gt;  $ county_name          : chr "WAKE"</span>
<span class="co">#&gt;  $ region_desc          : chr ""</span>
<span class="co">#&gt;  $ watershed_desc       : chr ""</span>
<span class="co">#&gt;  $ state_ansi           : chr "37"</span>
<span class="co">#&gt;  $ congr_district_code  : chr ""</span>
<span class="co">#&gt;  $ domaincat_desc       : chr "NOT SPECIFIED"</span>
<span class="co">#&gt;  $ state_fips_code      : chr "37"</span>
<span class="co">#&gt;  $ group_desc           : chr "FARMS &amp; LAND &amp; ASSETS"</span>
<span class="co">#&gt;  $ watershed_code       : chr "00000000"</span>
<span class="co">#&gt;  $ unit_desc            : chr "$"</span>
<span class="co">#&gt;  $ source_desc          : chr "CENSUS"</span>
<span class="co">#&gt;  $ load_time            : chr "2012-12-31 00:00:00"</span>
<span class="co">#&gt;  $ county_code          : chr "183"</span>
<span class="co">#&gt;  $ statisticcat_desc    : chr "ASSET VALUE"</span>
<span class="co">#&gt;  $ commodity_desc       : chr "AG LAND"</span>
<span class="co">#&gt;  $ year                 : chr "2012"</span></code></pre></div>
<p>The output of this query has a lot to digest, but the main focus is on the <code>Value</code> variable in the resulting data.frame. Please note that the returned <code>Value</code> for the query is of the class character. The parameter <code>numeric_vals</code> can be set to <code>TRUE</code> to have this return a numeric value, however the default is to be a character type as there are some suppressed values which will be coerced to <code>NA</code> when <code>numeric_vals</code> is set to <code>TRUE</code>.</p>
<p>Aside from the output, the particular query used four parameters for its output: <code>year</code>, <code>short_desc</code>, <code>county_name</code>, and <code>state_name</code>. Each of these parameters have a particular set of values which can generate of query, which can be figured out using the <code><a href="../reference/nass_param.html">nass_param()</a></code> function. In querying the Quick Stats API, you usually do not need to subset many parameters to get to the 50,000 limitation but if you do not get within the 50,000 limitation the call will produce an error.</p>
<p>There are 18 parameters for each query, although most of those will be <code>NULL</code> values and not required to specify an output.</p>
<div id="parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters" class="anchor"></a>Parameters</h2>
<p>There are 18 parameters which can be included in each query to Quick Stats however some of them are concatenations of other parameter values. If there is a name in quotations following a particular parameter, then that is the drop down menu via the <a href="https://www.nass.usda.gov/Quick_Stats/index.php">Quick Stats web interface</a> that gives you a value. Not all parameters will have a drop down menu though:</p>
<ol style="list-style-type: decimal">
<li>
<code>source_desc</code> “Program” - Source of data (“CENSUS” or “SURVEY”). Census program includes the Census of Ag as well as follow up projects. Survey program includes national, state, and county surveys.</li>
<li>
<code>sector_desc</code> “Sector” - Five high level, broad categories useful to narrow down choices. (“ANIMALS &amp; PRODUCTS”, “CROPS”, “DEMOGRAPHICS”, “ECONOMICS”, or “ENVIRONMENTAL”)</li>
<li>
<code>group_desc</code> “Group” - Subsets within sector (e.g., under sector_desc = “CROPS”, the groups are “FIELD CROPS”, “FRUIT &amp; TREE NUTS”, “HORTICULTURE”, and “VEGETABLES”).</li>
<li>
<code>commodity_desc</code> “Commodity” - The primary subject of interest (e.g., “CORN”, “CATTLE”, “LABOR”, “TRACTORS”, “OPERATORS”).</li>
<li>
<code>short_desc</code> “Data Item” - A concatenation of six columns: commodity_desc, class_desc, prodn_practice_desc, util_practice_desc, statisticcat_desc, and unit_desc.</li>
<li>
<code>domain_desc</code> “Domain” - Generally another characteristic of operations that produce a particular commodity (e.g., “ECONOMIC CLASS”, “AREA OPERATED”, “NAICS CLASSIFICATION”, “SALES”). For chemical usage data, the domain describes the type of chemical applied to the commodity. The domain_desc = “TOTAL” will have no further breakouts; i.e., the data value pertains completely to the short_desc.</li>
<li>
<code>domaincat_desc</code> “Domain Category” - Categories or partitions within a domain (e.g., under domain_desc = “SALES”, domain categories include $1,000 TO $9,999, $10,000 TO $19,999, etc).</li>
<li>
<code>agg_level_desc</code> “Geographic Level” - Aggregation level or geographic granularity of the data. (“AGRICULTURAL DISTRICT”, “COUNTY”, “INTERNATIONAL”, “NATIONAL”, “REGION : MULTI-STATE”, “REGION : SUB-STATE”, “STATE”, “WATERSHED”, or “ZIP CODE”)</li>
<li>
<code>statisticcat_desc</code> “Category” - The aspect of a commodity being measured (e.g., “AREA HARVESTED”, “PRICE RECEIVED”, “INVENTORY”, “SALES”).</li>
<li>
<code>state_name</code> “State” - State full name.</li>
<li>
<code>asd_desc</code> “Ag District” - Ag statistics district name.</li>
<li>
<code>county_name</code> “County” - County name.</li>
<li>
<code>region_desc</code> “Region” - NASS defined geographic entities not readily defined by other standard geographic levels. A region can be a less than a state (SUB-STATE) or a group of states (MULTI-STATE), and may be specific to a commodity.</li>
<li>
<code>zip_5</code> “Zip Code” - US Postal Service 5-digit zip code.</li>
<li>
<code>watershed_desc</code> “Watershed” - Name assigned to the HUC.</li>
<li>
<code>year</code> “Year” - The numeric year of the data and can be either a character or numeric vector. Conditional values are also possible, for example a character vector of “&gt;=1999” of “1999&lt;=” will give years greater than or equal to 1999. Right now the logical values can either be greater/less than or equal to with the logical at either the beginning or end of a string with the year.</li>
<li>
<code>freq_desc</code> “Period Type” - Length of time covered (“ANNUAL”, “SEASON”, “MONTHLY”, “WEEKLY”, “POINT IN TIME”). “MONTHLY” often covers more than one month. “POINT IN TIME” is as of a particular day.</li>
<li>
<code>reference_period_desc</code> “Period” - The specific time frame, within a freq_desc.</li>
</ol>
</div>
<div id="sample-code" class="section level2">
<h2 class="hasAnchor">
<a href="#sample-code" class="anchor"></a>Sample Code</h2>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example 1</h3>
<p>Find the number of observations for county level variables in Wake County North Carolina.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/nass_count.html">nass_count</a></span>(<span class="dt">state_name =</span> <span class="st">"NORTH CAROLINA"</span>, <span class="dt">county_name =</span> <span class="st">"WAKE"</span>)
<span class="co">#&gt; [1] 7008</span></code></pre></div>
</div>
<div id="example-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example 2</h3>
<p>View all of the parameter values for the group_desc category when the sector is CROPS.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/nass_param.html">nass_param</a></span>(<span class="st">"group_desc"</span>, <span class="dt">sector_desc =</span> <span class="st">"CROPS"</span>)
<span class="co">#&gt; [1] "CROP TOTALS"       "FIELD CROPS"       "FRUIT &amp; TREE NUTS"</span>
<span class="co">#&gt; [4] "HORTICULTURE"      "VEGETABLES"</span></code></pre></div>
</div>
<div id="example-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3" class="anchor"></a>Example 3</h3>
<p>Download the data pertaining to Wake County in 2012 for its value of agricultural land. Then look at the structure of the object returned by the function call.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#package-install">Package Install</a></li>
      <li>
<a href="#usage">Usage</a><ul class="nav nav-pills nav-stacked">
<li><a href="#key-install">Key Install</a></li>
      </ul>
</li>
      <li>
<a href="#get-data">Get Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#parameters">Parameters</a></li>
      <li><a href="#sample-code">Sample Code</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robert Dinterman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
